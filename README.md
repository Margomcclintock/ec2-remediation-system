# EC2 Monitoring and Remediation System \- ServiceNow Implementation

## Overview

**Company Context:** You're a ServiceNow Administrator and Jr Developer at Netflix, where reliable streaming infrastructure is critical for delivering content to over 260 million subscribers worldwide. AWS EC2 instances power Netflix's content delivery network, recommendation engines, and streaming services across multiple AWS regions.

**Your Role:** As a ServiceNow Admin and Jr Developer at Netflix, you've been tasked with building a semi-automated incident response system that helps the DevOps engineer team quickly remediate failing AWS EC2 instances that could impact streaming quality for millions of viewers.

**Why This Matters:** Last week, a critical AWS EC2 instance failure in the US-East region caused buffering issues for viewers streaming popular series during peak hours. The incident went undetected for 45 minutes because the existing monitoring system wasn't integrated with ServiceNow, and DevOps engineers had to search through documentation to find remediation procedures manually. This resulted in viewer complaints, trending social media criticism, and potential subscriber churn.

**The Business Problem:** Netflix's DevOps team needs a centralized system that automatically creates incidents when EC2 instances fail, provides AI-powered knowledge retrieval for remediation guidance, sends remediation guidance through Slack notifications, and allows engineers to trigger AWS remediation directly from ServiceNow during critical incidents.

## System Overview

**Netflix's AWS Integration Server:** Netflix operates an external monitoring system called the AWS Integration Server that continuously monitors EC2 instance health across all AWS regions and integrates with ServiceNow infrastructure. This server automatically populates your custom tables with real EC2 instance data every 1 minute. When you create your tables with the correct naming and scope, this system will detect them and begin sending instance information (ID, name, and status \- "ON" for operational, "OFF" for failed/stopped instances).

## Implementation Steps
1. **Build EC2 Monitoring Infrastructure (Steps 1 \- 3\)**

   - Design custom tables to record EC2 instance health and all remediation attempts
   - Set up a secure AWS integration to enable automated remediation calls
2. **Implement AI-Powered Knowledge Retrieval and Notification (Steps 6-7)**

   - Leverage an AI Search custom action to surface relevant remediation documentation
   - Create knowledge base articles that AI can discover during incidents
   - Notify the DevOps team on Slack with the retrieved knowledge article links
3. **Enable DevOps Team Workflow (Step 4-5)**

   - Deliver a one-click remediation interface for engineers using a UI Action and Script Includes
   - Implement automated incident response
   - Capture every remediation attempt for audit and analysis
4. **Test and Validate the Working System (Step 8\)**

   - Demonstrate a successful EC2 remediation workflow
   - Verify AI knowledge retrieval functionality
   - Confirm incident creation and Slack notification delivery

### Step 1: Application Setup

**Created a scoped application with the exact name:** `EC2 Monitoring and Remediation`

A scoped application was created with exact naming, as precise naming is required for AWS Integration Server compatibility and must match Netflix's internal system specifications. The provided name of the application autogenerated the scope name x\_snc\_ec2\_monito\_0.
<img width="934" height="401" alt="image" src="https://github.com/user-attachments/assets/10ef1cc4-f6e0-49a3-9529-5c0f930dd3be" />

### Step 2: Table Structure Requirements

**Important:** Once you create the EC2 Instance table with the correct name and scope, the AWS Integration Server will automatically populate it with EC2 instance data (instance ID and status) every minute. The instances will turn "OFF" every 10 minutes to provide opportunities for testing your remediation system.

**EC2 Instance Table:** Create table name `EC2 Instance` in your scoped application.

Required fields (note that ServiceNow automatically creates some fields; others must be manually added):
<img width="938" height="410" alt="image" src="https://github.com/user-attachments/assets/4d276cdb-419c-41d3-a0d3-e6fa6a624169" />

- Instance name (String, 40 characters)
- Instance ID (String, 40 characters)
- Instance status (String, 40 characters) \- will be populated by AWS Integration Server with "ON" or "OFF" values
- Created (Date/Time) \- auto-created
- Created by (String, 40 characters) \- auto-created
- Updated (Date/Time) \- auto-created
- Updated by (String, 40 characters) \- auto-created
- Updates (Integer) \- auto-created

**Remediation Log Table:** Create with table name `Remediation Log` in your scoped application.
<img width="938" height="142" alt="image" src="https://github.com/user-attachments/assets/9b22248b-aabb-4035-9f2b-0edfb34bb38f" />
<img width="926" height="360" alt="image" src="https://github.com/user-attachments/assets/c9b98767-1643-47f2-a395-81b5dca02614" />

Required fields:

- EC2 Instance (**Reference to EC2 Instance table**)
- Attempted Status (String, 40 characters)
- Success (True/False)
- Timestamp (Date/Time)
- Request Payload (String, 4000 characters)
- Response Payload (String, 4000 characters)
- Response Time (Integer)
- HTTP Status Code (Integer)
- Error Message (String, 4000 characters)
- Created (Date/Time) \- auto-created
- Created by (String, 40 characters) \- auto-created
- Updated (Date/Time) \- auto-created
- Updated by (String, 40 characters) \- auto-created
- Updates (Integer) \- auto-created

### Step 3: AWS Integration Configuration

The following naming conventions are **mandatory** for the remediation system to function:

**ServiceNow Connection & Credential Alias:**

- **Must be created within your scoped application**
- **Navigate to:** Connection & Credential Aliases
- **Create the following Connection and Credential Alias:**
- **Name:** `AWS Integration Server C C Alias`

**ServiceNow HTTP Connection:**

- **Use the URL builder to construct the connection properly**
- **Navigate to:** Connection & Credential Aliases \> Connection
- **Create the following Connection:**
- **Name:** `AWS Integration Server Connection`
- **Host:** `codon-staging.emaginelc.com`
- **Base path:** `/api/v1/queue/start`


**ServiceNow Credential Records (Type: Basic Auth):**

- **Navigate to:** Connection & Credential Aliases \> Credentials
- **Create the following credentials:**
- **Name:** `AWS Integration Server Credentials`
- **Type:** Basic Authentication
- **Username:** `admin`
- **Password:** Use your ServiceNow instance login password for basic authentication with AWS Integration Server

### Step 4: UI Action and Script Include Implementation

**Both components must be created within your scoped application.**

Use the provided code files from the GitHub repository:

- `trigger_EC2_Remediation.js` for the UI Action
- `EC2RemediationHelper.js` for the Script Include

**UI Action Configuration:**

- **Navigate to:** System UI \> UI Actions
- **Name:** `Trigger EC2 Remediation`
- **Table:** EC2 Instance (your scoped table)
- **Action name:** `trigger_EC2_remediation`
- **Form button:** Checked (this creates a button on the EC2 Instance form)
- **Active:** Checked
- **Show update:** Checked
- **Client:** Checked
- **List v2 Compatible:** Checked

**Script Include Configuration:**

- **Navigate to:** System Definition \> Script Includes
- **Name:** `EC2RemediationHelper`
- **API Name:** `x_snc_ec2_monito_0.EC2RemediationHelper` (auto-generated in scope)
- **Accessible from:** This application scope only
- **Glide AJAX enabled:** Checked
- **Active:** Checked

### Step 5: Flow Designer Workflow Creation

Create a single Flow Designer workflow within your scoped application that:

- Triggers when EC2 instance status equals 'OFF'
- Creates incident records for failed instances
- Uses the AI Search Custom action available in Flow Designer
- Sends Slack notifications with retrieved knowledge articles using webhook (URL provided via Slack DM)

**Important:** Use Flow Designer's "Force Save" option to ensure all workflow components are included in your update set.

### Step 6: AI Search Integration

Use the AI Search Custom action available in Flow Designer to retrieve knowledge articles during workflow execution. This action requires three parameters:

- **Search Term:** EC2-related search terms for knowledge retrieval
- **Enable Detailed Logging:** Must be enabled for proper functionality
- **Search App:** Research which AI Search App contains Knowledge Base articles on your instance and identify the correct search app name to use

Research what AI Search Apps are available on your instance and understand what sources they contain to determine which app to specify in the AI Search Custom action.
You can find the Search Apps by navigating to **All\>AI Search Admin\>AI Search Admin Home\>Applications** in your instance.

Hereâ€™s a guide on how you can test the **AI Search Custom** Action and familiarize yourself with its function:
[https://scribehow.com/viewer/Exploring_the_Workflow_Action_AI_Search_Custom__j6fD3CTxSRKIVuz7C47nzg?referrer=workspace](https://scribehow.com/viewer/Exploring_the_Workflow_Action_AI_Search_Custom__j6fD3CTxSRKIVuz7C47nzg?referrer=workspace)

Reference ServiceNow documentation on AI Search and AI Search Apps: [https://www.servicenow.com/docs/bundle/yokohama-platform-administration/page/administer/ai-search/concept/configuring-ais.html](https://www.servicenow.com/docs/bundle/yokohama-platform-administration/page/administer/ai-search/concept/configuring-ais.html)

### Step 7: Knowledge Base Content

The AI Search Custom action needs discoverable knowledge articles to retrieve during incidents. Create at least one knowledge base article that demonstrates the remediation process.

**Knowledge Article Content:** "Run the UI Action 'Trigger EC2 Remediation' on the associated record."

**Include these keywords to ensure AI Search discoverability:**

- EC2, server, instance, restart, AWS, virtual machine, cloud server, EC2 server, reboot

## Step 8: Testing and Validation

### DevOps User Testing

1. **Verify AWS Integration:** When you've successfully created your EC2 Instance table with the correct name and scope, the AWS Integration Server will automatically populate your table with EC2 information and status updates
2. Use the "Trigger EC2 Remediation" button on EC2 Instance forms to demonstrate the remediation workflow
3. Verify entries are created in the Remediation Log table when DevOps engineers click the remediation button

### System Verification

**AI Search Execution Logs:** Verify AI Search functionality by checking System Logs:

- Navigate to: System Logs \> System Log \> All
- Filter: All \> Created on Today \> Level \>= Information \> Message starts with "AI Search"
- Confirm your workflow successfully retrieved knowledge articles

**Flow Execution:** Ensure your Flow Designer workflow creates incident records when triggered by EC2 failures.

**Slack Integration:** Confirm Slack notifications are delivered to the DevOps channel using your assigned webhook URL.

## Deliverables

### Update Set Requirements

**Complete all implementation work before creating your update set.** Add components to update set after verifying functionality.

Your update set must contain these working components:


## Architecture Diagram
<img width="1891" height="958" alt="Diagram" src="https://github.com/user-attachments/assets/1284d6b0-61fb-4256-b8aa-d383d10e6d65" />


## Optimization
nhklhbik

## DevOps Usage
guogubjl
