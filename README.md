# EC2 Monitoring and Remediation System \- ServiceNow Implementation

## Overview

**Company Context:** You're a ServiceNow Administrator and Jr Developer at Netflix, where reliable streaming infrastructure is critical for delivering content to over 260 million subscribers worldwide. AWS EC2 instances power Netflix's content delivery network, recommendation engines, and streaming services across multiple AWS regions.

**Your Role:** As a ServiceNow Admin and Jr Developer at Netflix, you've been tasked with building a semi-automated incident response system that helps the DevOps engineer team quickly remediate failing AWS EC2 instances that could impact streaming quality for millions of viewers.

**Why This Matters:** Last week, a critical AWS EC2 instance failure in the US-East region caused buffering issues for viewers streaming popular series during peak hours. The incident went undetected for 45 minutes because the existing monitoring system wasn't integrated with ServiceNow, and DevOps engineers had to search through documentation to find remediation procedures manually. This resulted in viewer complaints, trending social media criticism, and potential subscriber churn.

**The Business Problem:** Netflix's DevOps team needs a centralized system that automatically creates incidents when EC2 instances fail, provides AI-powered knowledge retrieval for remediation guidance, sends remediation guidance through Slack notifications, and allows engineers to trigger AWS remediation directly from ServiceNow during critical incidents.

## System Overview

**Netflix's AWS Integration Server:** Netflix operates an external monitoring system called the AWS Integration Server that continuously monitors EC2 instance health across all AWS regions and integrates with ServiceNow infrastructure. This server automatically populates your custom tables with real EC2 instance data every 1 minute. When you create your tables with the correct naming and scope, this system will detect them and begin sending instance information (ID, name, and status \- "ON" for operational, "OFF" for failed/stopped instances).

## Implementation Steps
1. **Build EC2 Monitoring Infrastructure (Steps 1 \- 3\)**

   - Design custom tables to record EC2 instance health and all remediation attempts
   - Set up a secure AWS integration to enable automated remediation calls
2. **Implement AI-Powered Knowledge Retrieval and Notification (Steps 6-7)**

   - Leverage an AI Search custom action to surface relevant remediation documentation
   - Create knowledge base articles that AI can discover during incidents
   - Notify the DevOps team on Slack with the retrieved knowledge article links
3. **Enable DevOps Team Workflow (Step 4-5)**

   - Deliver a one-click remediation interface for engineers using a UI Action and Script Includes
   - Implement automated incident response
   - Capture every remediation attempt for audit and analysis
4. **Test and Validate the Working System (Step 8\)**

   - Demonstrate a successful EC2 remediation workflow
   - Verify AI knowledge retrieval functionality
   - Confirm incident creation and Slack notification delivery

### Step 1: Application Setup

**Created a scoped application with the exact name:** `EC2 Monitoring and Remediation`

A scoped application was created with exact naming, as precise naming is required for AWS Integration Server compatibility and must match Netflix's internal system specifications. The provided name of the application autogenerated the scope name x\_snc\_ec2\_monito\_0.
<img width="934" height="401" alt="image" src="https://github.com/user-attachments/assets/10ef1cc4-f6e0-49a3-9529-5c0f930dd3be" />

### Step 2: Table Structure Requirements

**Important:** Once the EC2 Instance table was created with the correct name and scope, the AWS Integration Server automatically populated it with EC2 instance data (instance ID and status) every minute. The instances turn "OFF" every 10 minutes to provide opportunities for testing the remediation system.

**EC2 Instance Table:** An "EC2 Instance" table was created in the scoped application.

Required fields (note that ServiceNow automatically creates some fields; others must be manually added):

- Instance name (String, 40 characters)
- Instance ID (String, 40 characters)
- Instance status (String, 40 characters) \- will be populated by AWS Integration Server with "ON" or "OFF" values
- Created (Date/Time) \- auto-created
- Created by (String, 40 characters) \- auto-created
- Updated (Date/Time) \- auto-created
- Updated by (String, 40 characters) \- auto-created
- Updates (Integer) \- auto-created

<img width="938" height="410" alt="image" src="https://github.com/user-attachments/assets/4d276cdb-419c-41d3-a0d3-e6fa6a624169" />

 
**Remediation Log Table:**  Created with table name `Remediation Log` in the scoped application.

Required fields:

- EC2 Instance (**Reference to EC2 Instance table**)
- Attempted Status (String, 40 characters)
- Success (True/False)
- Timestamp (Date/Time)
- Request Payload (String, 4000 characters)
- Response Payload (String, 4000 characters)
- Response Time (Integer)
- HTTP Status Code (Integer)
- Error Message (String, 4000 characters)
- Created (Date/Time) \- auto-created
- Created by (String, 40 characters) \- auto-created
- Updated (Date/Time) \- auto-created
- Updated by (String, 40 characters) \- auto-created
- Updates (Integer) \- auto-created
  
<img width="938" height="142" alt="image" src="https://github.com/user-attachments/assets/9b22248b-aabb-4035-9f2b-0edfb34bb38f" />
<img width="926" height="360" alt="image" src="https://github.com/user-attachments/assets/c9b98767-1643-47f2-a395-81b5dca02614" />

### Step 3: AWS Integration Configuration

The following naming conventions were **mandatory** for the remediation system to function:

**ServiceNow Connection & Credential Alias:**

- **Must be created within your scoped application**
- **Navigate to:** Connection & Credential Aliases
- **Create the following Connection and Credential Alias:**
- **Name:** `AWS Integration Server C C Alias`
<img width="922" height="406" alt="image" src="https://github.com/user-attachments/assets/09f10300-e5d0-41cf-9d6c-ba47bdfa12e3" />


**ServiceNow HTTP Connection:**

- **Use the URL builder to construct the connection properly**
- **Navigate to:** Connection & Credential Aliases \> Connection
- **Create the following Connection:**
- **Name:** `AWS Integration Server Connection`
- **Host:** `codon-staging.emaginelc.com`
- **Base path:** `/api/v1/queue/start`
<img width="940" height="409" alt="image" src="https://github.com/user-attachments/assets/64628297-68ef-4109-8b4c-84d52f31ff2b" />


**ServiceNow Credential Records (Type: Basic Auth):**

- **Navigate to:** Connection & Credential Aliases \> Credentials
- **Create the following credentials:**
- **Name:** `AWS Integration Server Credentials`
- **Type:** Basic Authentication
- **Username:** `admin`
- **Password:** I used my ServiceNow instance login password for basic authentication with AWS Integration Server
<img width="936" height="406" alt="image" src="https://github.com/user-attachments/assets/5fb5039a-5410-4433-a909-452274ae6c32" />

### Step 4: UI Action and Script Include Implementation

**Both components were created within the scoped application.**

I used the provided code files from the GitHub repository:

- `trigger_EC2_Remediation.js` for the UI Action
- `EC2RemediationHelper.js` for the Script Include

**UI Action Configuration:**

- **Navigate to:** System UI \> UI Actions
- **Name:** `Trigger EC2 Remediation`
- **Table:** EC2 Instance (your scoped table)
- **Action name:** `trigger_EC2_remediation`
- **Form button:** Checked (this creates a button on the EC2 Instance form)
- **Active:** Checked
- **Show update:** Checked
- **Client:** Checked
- **List v2 Compatible:** Checked
<img width="941" height="404" alt="image" src="https://github.com/user-attachments/assets/f64be377-ab9c-414e-95a4-402b14579596" />
<img width="932" height="323" alt="image" src="https://github.com/user-attachments/assets/8e1f1586-8611-4e9d-bf04-7a717db3eb4e" />

**Script Include Configuration:**

- **Navigate to:** System Definition \> Script Includes
- **Name:** `EC2RemediationHelper`
- **API Name:** `x_snc_ec2_monito_0.EC2RemediationHelper` (auto-generated in scope)
- **Accessible from:** This application scope only
- **Glide AJAX enabled:** Checked
- **Active:** Checked
<img width="934" height="188" alt="image" src="https://github.com/user-attachments/assets/97bb7c5a-28e9-48fc-80e0-dd8e1307e56e" />
<img width="937" height="290" alt="image" src="https://github.com/user-attachments/assets/69f12d8a-1905-4015-95d8-11de74437ace" />

### Step 5: Flow Designer Workflow Creation

I created a single Flow Designer workflow within the scoped application that:

- Triggers when EC2 instance status equals 'OFF'
  <img width="787" height="271" alt="image" src="https://github.com/user-attachments/assets/f062f8f3-d7b1-4e18-98a9-1a577adeea03" />

- Creates incident records for failed instances
  <img width="772" height="338" alt="image" src="https://github.com/user-attachments/assets/bc441e73-ec11-4b75-b53d-bcf0deb2dbce" />

- Uses the AI Search Custom action available in Flow Designer
  <img width="789" height="239" alt="image" src="https://github.com/user-attachments/assets/c346ea66-9a90-4f69-83bc-3b41da0ebc50" />

- Sends Slack notifications with retrieved knowledge articles using webhook (URL provided via Slack DM)
  <img width="785" height="280" alt="image" src="https://github.com/user-attachments/assets/864ebbe3-0307-46ea-b108-ccc0f566a78d" />

**Important:** I used Flow Designer's "Force Save" option to ensure all workflow components are included in my update set.

### Step 6: AI Search Integration

I used the AI Search Custom action available in Flow Designer to retrieve knowledge articles during workflow execution. This action required three parameters:

- **Search Term:** EC2-related search terms for knowledge retrieval
- **Enable Detailed Logging:** Must be enabled for proper functionality
- **Search App:** Research which AI Search App contains Knowledge Base articles on your instance and identify the correct search app name to use

### Step 7: Knowledge Base Content

The AI Search Custom action needs discoverable knowledge articles to retrieve during incidents. I created at least one knowledge base article that demonstrated the remediation process.

**Knowledge Article Content:** "Run the UI Action 'Trigger EC2 Remediation' on the associated record."

**Included these keywords to ensure AI Search discoverability:**

- EC2, server, instance, restart, AWS, virtual machine, cloud server, EC2 server, reboot
<img width="1907" height="684" alt="image" src="https://github.com/user-attachments/assets/0f0e4d83-94c1-46c3-9cef-0bf9de6b9894" />
<img width="1891" height="876" alt="image" src="https://github.com/user-attachments/assets/c0ce81c1-69f1-443f-82a4-d07de329bc2c" />

## Step 8: Testing and Validation

### DevOps User Testing

1. **Verify AWS Integration:** When the EC2 Instance Tbale was successfully created with the correct name and scope, the AWS Integration Server automatically populated the table with EC2 information and status updates
2. I used the "Trigger EC2 Remediation" button on EC2 Instance forms to demonstrate the remediation workflow
   <img width="1900" height="520" alt="image" src="https://github.com/user-attachments/assets/c51e72b8-9d4b-42b0-9297-0eeb54914bf1" />

3. I verified that the entries were created in the Remediation Log table when DevOps engineers click the remediation button

<img width="1914" height="184" alt="image" src="https://github.com/user-attachments/assets/8e8f97e4-2cb1-44aa-9d23-9292400bee4b" />

### System Verification

**AI Search Execution Logs:** I verified the AI Search functionality by checking the System Logs:

- Navigate to: System Logs \> System Log \> All
- Filter: All \> Created on Today \> Level \>= Information \> Message starts with "AI Search"
- Confirm your workflow successfully retrieved knowledge articles

**Flow Execution:** I ensured my Flow Designer workflow created incident records when triggered by EC2 failures.

<img width="1905" height="904" alt="image" src="https://github.com/user-attachments/assets/0f3b2a42-efb5-4335-9968-0e62ee4a8045" />


**Slack Integration:** Confirm Slack notifications were delivered to the DevOps channel using my assigned webhook URL.

<img width="1370" height="270" alt="image" src="https://github.com/user-attachments/assets/bf8edb0f-9ac1-49c4-a48b-0252ce04f8c7" />

## Deliverables

### Update Set Requirements
<img width="1885" height="902" alt="image" src="https://github.com/user-attachments/assets/d56516ba-3533-40e7-9fdc-05fde960129f" />

<img width="1851" height="518" alt="image" src="https://github.com/user-attachments/assets/b8f2256e-2257-49a4-941a-c7bf1bf19a66" />


## Architecture Diagram
<img width="1891" height="958" alt="Diagram" src="https://github.com/user-attachments/assets/1284d6b0-61fb-4256-b8aa-d383d10e6d65" />


## DevOps Usage
The EC2 Monitoring and Remediation system was implemented to detect critical AWS EC2 instance failures. When the EC2 table reports a critical incident, the remediation table logs the incident details so the DevOps team can see the exact time, date, payload, and HTTP status code associated with the failure.

From there, a DevOps team member can select the incident in the EC2 table and click the “Trigger EC2 Remediation” button. Doing so launches a custom AI Search action that surfaces relevant remediation documentation and automatically delivers it to the DevOps team via Slack notification.

Previously, the DevOps team had to manually search through documentation to find the right remediation steps. With the AI-powered retrieval and notification system in place, those manual searches are eliminated. Instead, AI quickly locates the correct solution, enabling faster problem resolution.

**Business Impact**

The EC2 Monitoring and Remediation system eliminates the delays and manual effort that previously slowed down Netflix’s response to AWS EC2 failures. By automatically logging incidents with exact time, date, payload, and HTTP status codes, engineers no longer waste time piecing together failure details.

Instead of manually searching through documentation, the AI-powered retrieval surfaces the right remediation steps instantly and delivers them to the DevOps team in Slack. With one click, engineers can trigger remediation directly from ServiceNow, cutting resolution time from nearly an hour to minutes.

This faster response reduces buffering issues for viewers, prevents large-scale streaming interruptions, and protects Netflix from negative customer experiences, social media backlash, and potential subscriber churn.
